<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <title id="title">jamesbjenkins - home</title>
</head>

<body id="body">
    <div id="container">
        <div id="header">
            <div class="title">dead-bird!</div>
                <div class="tab-selector"></div>
        </div>
        
        <div id="content"></div>
    </div>
    
    <script id="injected-script"></script>

    <script>
        var tabList = ["home", "portfolio", "bugs"]; // must be updated 

        // tab select callback
        let select = (e) => {
            let name = e.target.innerText; // get name
            // remove underlines from tabs
            document.querySelectorAll("#header .tab-selector button").forEach((elem) => {elem.style.textDecoration = "none"});
            e.target.style.textDecoration = "underline"; // add underline back under active tab

            // using fetch :(
            fetch("resources/tabs/" + name + ".html").then((response) => {
                return response.text().then((text) => {
                    document.getElementById("content").innerHTML = text;
                });
            });
        }

        main = () => {
            // background, might need other options for a light mode
            var newScript = document.createElement("script");
            newScript.src = "resources/background.js";
            document.getElementById("body").appendChild(newScript);

            //weather // TODO: weather effects
            navigator.geolocation.getCurrentPosition((pos) => {
                //console.log(pos.coords.accuracy);
            })
            // feed to https://forecast.weather.gov/MapClick.php?lat=38.301180000000045&lon=-77.45932999999997

            // load tabs/buttons
            tabList.forEach((tabName) => {
                let button = document.createElement("button");
                button.innerText = tabName;
                button.addEventListener("click", select);
                button.addEventListener("touchend", select);
                document.querySelector("#header .tab-selector").appendChild(button);
            });

            // dispatch a click to the home tab to default it
            document.querySelector("#header .tab-selector button").dispatchEvent(new MouseEvent('click', {
                view: window,
                bubbles: true,
                cancelable: true
            }));
        }

        main();
    </script>
</body>
</html>