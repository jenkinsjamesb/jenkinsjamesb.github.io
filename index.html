<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/styles.css">
    <link rel="shortcut icon" href="/favicon.png" type="image/png">
    <title id="title">jamesbjenkins - home</title>
</head>

<body id="body">
    <div id="container">
        
        <div id="content"></div>

        <div id="tabcontainer">
            <table rules=>
                <tbody>
                    <!-- This "head" td shouldn"t be necessary but the tab positions breaks slightly if removed. no touch--> 
                    <tr><td class="tab" id="head-tab"></td></tr>
                    <tr><td class="tab" id="home-tab">Home</td></tr>
                    <tr><td class="tab" id="portfolio-tab">Portfolio</td></tr>
                    <tr><td class="tab" id="2-tab">soon™</td></tr>  
                    <tr><td class="tab" id="3-tab">soon™</td></tr>
                    <tr><td class="tab" id="4-tab">soon™</td></tr>
                    <tr><td class="tab" id="5-tab">soon™</td></tr>
                    <tr><td class="tab" id="6-tab">soon™</td></tr>
                    <tr><td class="tab" id="7-tab">soon™</td></tr>
                    <tr><td class="tab" id="demos-tab">Demos</td></tr>
                    <tr><td class="tab" id="bugs-tab">Bug Reports</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <script id="inject-script"></script>

    <script>
        //sets home as default tab
        var active = document.querySelector("#home-tab"), activeId = active.getAttribute("id");
        active.classList.add("active");
    
        //replaces content div with requested file
        const update_content = async () => {
            //gets html file
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/resources/tabs/" + activeId + ".html", true);
            xhr.onreadystatechange = function() {
                if (this.readyState !== 4) return;
                if (this.status !== 200) return;
                document.getElementById("content").innerHTML = this.responseText;
            };
            xhr.send();
            document.getElementById("title").innerText = "jamesbjenkins - " + activeId.replace("-tab", ""); //updates page title
            //location.hash = ""; may eventually be necessary
            
            //gets js file
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "resources/tabs/" + activeId + ".js", true);
            xhr.onreadystatechange = function() {
                if (this.readyState !== 4) return;
                if (this.status !== 200) return;
                document.getElementById("inject-script").innerHTML = this.responseText;
            };
            xhr.send();
        }
    
        update_content();   //intial call to make the page look right
        
        //listen for a click on the tab !!does not work on mobile
        window.onmousedown = (e) => {
            let tabSelected = e.target.getAttribute("class") == "tab";
            active.classList.remove("active");
            tabSelected ? active = e.target:null;
            activeId = active.getAttribute("id");
            active.classList.add("active");
            tabSelected ? update_content():null; //must be conditional, or page refreshes will mess things up
        }

        /*NOTES:
    
            //alt script import
            var newScript = document.createElement("script");
            newScript.src = "resources/script.js";
            document.getElementById("body").appendChild(newScript);
    
            every tab should have a .js file for scripts if needed

            MOBILE SUPPORT
            flexbox integration because holy shit
        */
    </script>
</body>
</html>